<title>Profile</title>
{% include 'index.html' %}
<div class="container-fluid text-center text-white">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="alert alert-success alert-dismissible fade show custom-alert text-center" role="alert">
        {% for message in messages %}
        <p class="mb-0">{{ message }}</p>
        {% endfor %}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}
    {% endwith %}
    <div class="row">
        <div class="col-md-8">
            <h1>Welcome, {{ current_user.username }}</h1>
            <!-- Form for uploading image -->
            <div class="mx-auto">
                <form action="{{ url_for('main.upload_image') }}" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="image">Upload Image:</label>
                        <input type="file" class="form-control-file" id="image" name="image"
                            onchange="updateFileName(this)">
                        <p id="file-name" class="mt-2 text-muted">No file chosen</p>
                    </div>
                    <button type="submit" class="btn btn-primary">Upload</button>
                </form>
            </div>
            <!-- Display user's images if available -->
            {% if user_images %}
            <div class="image-container">
                {% for image in user_images %}
                <img src="{{ url_for('main.get_image', image_id=image.id) }}" alt="{{ image.filename }}">
                {% endfor %}
            </div>
            {% else %}
            <p>No images uploaded for the current user.</p>
            {% endif %}
        </div>
        <div class="col-md-4">
            <form class="mx-auto" id="logoutForm" action="{{ url_for('auth.logout') }}" method="post">
                <h4 class="text-center">Logout</h4>
                <button type="submit" class="btn btn-primary">Logout</button>
            </form>
        </div>
    </div>
</div>

<style>
    .image-container {
        display: flex;
        flex-wrap: wrap;
        /* Allow images to wrap to the next line if needed */
        justify-content: center;
        /* Center images horizontally */
        margin-top: 20px;
        /* Adjust margin as needed */
    }

    .image-container img {
        margin-right: 10px;
        /* Adjust spacing between images */
        margin-bottom: 10px;
        /* Adjust spacing between rows of images */
    }
</style>

<script>
    function updateFileName(input) {
        var fileName = input.files[0].name;
        var fileNameElement = document.getElementById("file-name");
        fileNameElement.innerText = fileName;
    }
</script>